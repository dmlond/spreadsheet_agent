<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: SpreadsheetAgent::Runner</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/spreadsheet_agent/runner_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/spreadsheet_agent/runner.rb">lib/spreadsheet_agent/runner.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="Db.html">SpreadsheetAgent::Db</a></p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-only_pages_if">#only_pages_if</a></li>
          
          <li><a href="#method-i-process-21">#process!</a></li>
          
          <li><a href="#method-i-skip_entry">#skip_entry</a></li>
          
          <li><a href="#method-i-skip_goal">#skip_goal</a></li>
          
          <li><a href="#method-i-skip_pages_if">#skip_pages_if</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="../Rakefile.html">Rakefile</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../SpreadsheetAgent.html">SpreadsheetAgent</a></li>
        
          <li><a href="../SpreadsheetAgent/Agent.html">SpreadsheetAgent::Agent</a></li>
        
          <li><a href="../SpreadsheetAgent/Db.html">SpreadsheetAgent::Db</a></li>
        
          <li><a href="../SpreadsheetAgent/Error.html">SpreadsheetAgent::Error</a></li>
        
          <li><a href="../SpreadsheetAgent/Runner.html">SpreadsheetAgent::Runner</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">SpreadsheetAgent::Runner</h1>

    <div id="description" class="description">
      
<p><a href="Runner.html">SpreadsheetAgent::Runner</a> is a class designed to
facilitate the automated traversal of all, or some defined set of pages,
entries, and goals defined in a <a
href="../SpreadsheetAgent.html">SpreadsheetAgent</a> compatible Google
Spreadsheet, and run agents or processes on them.  By placing a <a
href="Runner.html">SpreadsheetAgent::Runner</a> script into the scheduling
system (cron, etc.) on one or more compute nodes, desired pages, entries,
and goals can be processed efficiently over a period of time, and new
pages, entries, or goals can be automatically picked up as they are
introduced.  Runners can be designed to automate the submission of agent
scripts, check the status of jobs, aggregate information about job status,
or automate cleanup tasks.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="agent_bin-attribute-method" class="method-detail">
          <a name="agent_bin"></a>
          
          <a name="agent_bin="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">agent_bin</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>String Path, Optional.  The path to the directory containing agent
executable programs that the default process PROC executes.  The default is
the ../agent_bin directory relative to the directory containing the calling
script, $0.</p>
          
          </div>
        </div>
        
        <div id="debug-attribute-method" class="method-detail">
          <a name="debug"></a>
          
          <a name="debug="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">debug</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>Boolean, Optional (default false). If true, information about pages,
entries, and goals that are checked and filtered is printed to STDERR.</p>
          
          </div>
        </div>
        
        <div id="dry_run-attribute-method" class="method-detail">
          <a name="dry_run"></a>
          
          <a name="dry_run="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">dry_run</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>Boolean. Optional (default false). If true, run will generate the commands
that it would run for all runnable entry-goals, print them to STDERR, but
not actually run the commands. Automatically sets debug to 1. Note, if the
process_entries_with coderef is overridden, <a
href="Runner.html#attribute-i-dry_run">dry_run</a> is ignored.</p>
          
          </div>
        </div>
        
        <div id="only_pages-attribute-method" class="method-detail">
          <a name="only_pages"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">only_pages</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>Readonly access to the array of pages to be processed.  Only pages will
only be defined when :<a
href="Runner.html#attribute-i-only_pages">only_pages</a> or :skip_pages are
defined in the constructor params, or when the <a
href="Runner.html#method-i-skip_pages_if">skip_pages_if</a>, or <a
href="Runner.html#method-i-only_pages_if">only_pages_if</a> methods are
called.</p>
          
          </div>
        </div>
        
        <div id="query_fields-attribute-method" class="method-detail">
          <a name="query_fields"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">query_fields</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          <p>Readonly access to the Hash of field - value key_fields, as defined in
:config</p>
          
          </div>
        </div>
        
        <div id="run_in_serial-attribute-method" class="method-detail">
          <a name="run_in_serial"></a>
          
          <a name="run_in_serial="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">run_in_serial</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>Boolean, Optional (default false). If true, the default
process_entries_with PROC runs each agent_script executable in the
foreground, rather than in the background, thus in serial. If false, all
agent_script executables are run in parallel, in the background.  This is
not used when process_entries_with is set to a different PROC.</p>
          
          </div>
        </div>
        
        <div id="sleep_between-attribute-method" class="method-detail">
          <a name="sleep_between"></a>
          
          <a name="sleep_between="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">sleep_between</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>Integer, Optional (default 5). The number of seconds that the runner sleeps
between each call to process an entry-goal.</p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(attributes = { })</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Create a new <a href="Runner.html">SpreadsheetAgent::Runner</a>.  Can be
created with any of the following optional attributes:</p>
<ul><li>
<p>:skip_pages - raises SpreadsheetAgentError if passed along with :<a
href="Runner.html#attribute-i-only_pages">only_pages</a></p>
</li><li>
<p>:<a href="Runner.html#attribute-i-only_pages">only_pages</a> - raises
SpreadsheetAgentError if passed along with :skip_pages</p>
</li><li>
<p>:<a href="Runner.html#attribute-i-dry_run">dry_run</a></p>
</li><li>
<p>:<a href="Runner.html#attribute-i-run_in_serial">run_in_serial</a></p>
</li><li>
<p>:debug</p>
</li><li>
<p>:config_file (see <a href="Db.html">SpreadsheetAgent::Db</a>)</p>
</li><li>
<p>:<a href="Runner.html#attribute-i-sleep_between">sleep_between</a></p>
</li><li>
<p>:<a href="Runner.html#attribute-i-agent_bin">agent_bin</a></p>
</li></ul>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/spreadsheet_agent/runner.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">attributes</span> = { })
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">attributes</span>[<span class="ruby-value">:skip_pages</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">attributes</span>[<span class="ruby-value">:only_pages</span>].<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">SpreadsheetAgentError</span>, <span class="ruby-string">&quot;You cannot construct a runner with both only_pages and skip_pages&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@dry_run</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:dry_run</span>]
  <span class="ruby-ivar">@run_in_serial</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:run_in_serial</span>]
  <span class="ruby-ivar">@debug</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:debug</span>]
  <span class="ruby-ivar">@config_file</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:config_file</span>]

  <span class="ruby-ivar">@sleep_between</span> = <span class="ruby-value">5</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:sleep_between</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@sleep_between</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:sleep_between</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@agent_bin</span> = <span class="ruby-identifier">find_bin</span>() <span class="ruby-operator">+</span> <span class="ruby-string">'../agent_bin'</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:agent_bin</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@agent_bin</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:agent_bin</span>]      
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:skip_pages</span>]
    <span class="ruby-ivar">@skip_pages</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:skip_pages</span>].<span class="ruby-identifier">clone</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:only_pages</span>]
    <span class="ruby-ivar">@only_pages</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-value">:only_pages</span>].<span class="ruby-identifier">clone</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">build_db</span>()
  <span class="ruby-ivar">@query_fields</span> = <span class="ruby-identifier">build_query_fields</span>()

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@skip_pages</span>
    <span class="ruby-identifier">skip_pages_if</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">page</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@skip_pages</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">page</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dry_run</span>
    <span class="ruby-ivar">@debug</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="only_pages_if-method" class="method-detail ">
          <a name="method-i-only_pages_if"></a>

          
          <div class="method-heading">
            <span class="method-name">only_pages_if</span><span
              class="method-args">(&include_code)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Provide a PROC desinged to intelligently determine pages to process. If not
called, all pages not affected by the :skip_pages, or :<a
href="Runner.html#attribute-i-only_pages">only_pages</a> constructor
params, or a previous call to <a
href="Runner.html#method-i-skip_pages_if">skip_pages_if</a> will be
processed. This will override <a
href="Runner.html#attribute-i-only_pages">only_pages</a>, or skip_pages
passed as arguments to the constructor, and any previous call to <a
href="Runner.html#method-i-skip_pages_if">skip_pages_if</a>, or
only_pages_if.  The PROC should take the title of a page as a string, and
return true if a process decides to include the page, false otherwise. Must
be called before the process! method to affect the pages it processes. 
Returns the runner self to facilitate chained processing with <a
href="Runner.html#method-i-skip_goal">skip_goal</a>, <a
href="Runner.html#method-i-skip_entry">skip_entry</a>, and/or process! if
desired.</p>

<pre>include only pages whose title begins with 'foo'
runner.only_pages_if {|title| title.match(/^foo/)}.process!

Same, but without calling process so that skip_entry or skip_goal can be called on the runner
runner.only_pages_if do |title|
  title.match(/^foo/)
end
... can call skip_entry, skip_goal
runner.process!</pre>
            

            
            <div class="method-source-code" id="only_pages_if-source">
<pre>
<span class="ruby-comment"># File lib/spreadsheet_agent/runner.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">only_pages_if</span>(&amp;<span class="ruby-identifier">include_code</span>)
  <span class="ruby-ivar">@only_pages</span> = <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">worksheets</span>.<span class="ruby-identifier">collect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">title</span> }.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ptitle</span><span class="ruby-operator">|</span> <span class="ruby-identifier">include_code</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">ptitle</span>) }
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- only_pages_if-source -->
            
          </div>

          

          
        </div><!-- only_pages_if-method -->

      
        <div id="process-21-method" class="method-detail ">
          <a name="method-i-process-21"></a>

          
          <div class="method-heading">
            <span class="method-name">process!</span><span
              class="method-args">(&runner_code)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Processes configured pages, entries, and goals with a PROC.  The default
PROC takes the entry, iterates over each goal not skipped by <a
href="Runner.html#method-i-skip_goal">skip_goal</a>, and:</p>
<ul><li>
<p>determines if an executable #{ @<a
href="Runner.html#attribute-i-agent_bin">agent_bin</a> }/#{ goal }_agent.rb
script exists</p>
</li><li>
<p>if so, executes the goal_agent script with commandline arguments
constructed from the values in the entry for each field in the <a
href="Runner.html#attribute-i-query_fields">query_fields</a> array defined
in config.</p>
</li></ul>

<p>If <a href="Runner.html#attribute-i-run_in_serial">run_in_serial</a> is
false, the default PROC runs each agent in the background, in parallel.
Otherwise, it runs each serially in the foreground.  If <a
href="Runner.html#attribute-i-dry_run">dry_run</a> is true, the command is
printed to STDERR, but is not run. A PROC supplied to override the default
PROC should take an GoogleDrive::List, and GoogleDrive::Worksheet as
arguments. This allows the process to query the entry for information using
its hash access, and/or update the entry on the spreadsheet. In order for
changes to the GoogleDrive::List to take effect, the GoogleDrive::Worksheet
must be saved in the PROC. The process sleeps @<a
href="Runner.html#attribute-i-sleep_between">sleep_between</a> between each
call to the PROC (default or otherwise).  If <a
href="Runner.html#attribute-i-dry_run">dry_run</a> is true when a PROC is
supplied, the page.title and runnable_entry hash inspection are printed to
STDERR but the PROC is not called.</p>

<pre> # call each goal agent script in agent_bin on each entry in each page
 runner = SpreadsheetAgent::Runer.new
 runner.process!

 # find entries with a threshold &gt; 5 and update the 'threshold_exceeded' field
 runner.skip_entry{|entry| entry['threshold'] &lt;= 5 }.process! do |entry,page|
   entry.update 'threshold_exceeded', &quot;1&quot;
   page.save

# only process entries on the 'main' page where the threshold has not been exceeded
runner.only_pages = ['main']
runner.skip_entry{|entry| entry['threshold'] != 1 }.process!</pre>
            

            
            <div class="method-source-code" id="process-21-source">
<pre>
<span class="ruby-comment"># File lib/spreadsheet_agent/runner.rb, line 223</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">process!</span>(&amp;<span class="ruby-identifier">runner_code</span>)
  <span class="ruby-identifier">get_runnable_entries</span>().<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">entry_info</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">entry_page</span>, <span class="ruby-identifier">runnable_entry</span> = <span class="ruby-identifier">entry_info</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">runner_code</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">default_process</span>(<span class="ruby-identifier">runnable_entry</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@dry_run</span>
      <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;Would run #{ entry_page.title } #{ runnable_entry.inspect }&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">runner_code</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">runnable_entry</span>, <span class="ruby-identifier">entry_page</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">sleep</span> <span class="ruby-ivar">@sleep_between</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- process-21-source -->
            
          </div>

          

          
        </div><!-- process-21-method -->

      
        <div id="skip_entry-method" class="method-detail ">
          <a name="method-i-skip_entry"></a>

          
          <div class="method-heading">
            <span class="method-name">skip_entry</span><span
              class="method-args">(&skip_code)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Provide a PROC desinged to intelligently determine entries on any page to
skip. If not called, all entries on processed pages will be processed. The
PROC should take a GoogleDrive::List representing the record in the
spreadsheet, which can be accessed as a Hash with fields as key and that
fields value as value.  It should return true if the code decides to skip
processing the entry, false otherwise.  Must be called before the process!
method to affect the entries on each page that it processes.  Returns the
runner self to facilitate chained processing with <a
href="Runner.html#method-i-skip_pages_if">skip_pages_if</a>, <a
href="Runner.html#method-i-only_pages_if">only_pages_if</a>, <a
href="Runner.html#method-i-skip_goal">skip_goal</a>, and/or process! if
desired.</p>

<pre>skip entries which have run foo or bar
runner.only_pages_if {|entry| entry['foo'] == 1 || entry['bar'] == 1 }.process!

skip entries that a human reading the spreadsheet has annotated with less than 3.5 in the 'threshold' field
runner.only_pages_if do |entry|
  entry['threshold'] &lt; 3.5
end
... can call skip_pages_if, only_pages_if, skip_goal
runner.process!</pre>
            

            
            <div class="method-source-code" id="skip_entry-source">
<pre>
<span class="ruby-comment"># File lib/spreadsheet_agent/runner.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_entry</span>(&amp;<span class="ruby-identifier">skip_code</span>)
  <span class="ruby-ivar">@skip_entry_code</span> = <span class="ruby-identifier">skip_code</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- skip_entry-source -->
            
          </div>

          

          
        </div><!-- skip_entry-method -->

      
        <div id="skip_goal-method" class="method-detail ">
          <a name="method-i-skip_goal"></a>

          
          <div class="method-heading">
            <span class="method-name">skip_goal</span><span
              class="method-args">(&skip_code)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Provide a PROC desinged to skip a specific goal in any entry on all pages
processed. If not called, all goals of each entry and page to be processed
by the runner will be processed.</p>

<pre>[note!] Ignored when a PROC is passed to the process! method, e.g. it is only used when process! executes
agent scripts for the goal.</pre>

<p>The PROC should take a string, which will be one of the header fields in
the spreadsheet.  It should return true if that goal is to be skipped,
falsed otherwise. Returns the runner self to facilitate chained processing
with <a href="Runner.html#method-i-skip_pages_if">skip_pages_if</a>, <a
href="Runner.html#method-i-only_pages_if">only_pages_if</a>, <a
href="Runner.html#method-i-skip_entry">skip_entry</a>, and/or process! if
desired.</p>

<pre>skip the 'post_process' goal on each entry of each page processed
runner.skip_goal{|goal| goal == 'post_process' }.process!</pre>

<p>This is best when used in conjunction with <a
href="Runner.html#method-i-skip_entry">skip_entry</a> to skip_goals for
particular entries runner.skip_entry{|entry| <a
href="http://'threshold'">entry</a> &lt; 2.5 }.<a
href="Runner.html#method-i-skip_goal">skip_goal</a>{|goal| goal ==
‘post_process’ }.process!</p>
            

            
            <div class="method-source-code" id="skip_goal-source">
<pre>
<span class="ruby-comment"># File lib/spreadsheet_agent/runner.rb, line 191</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_goal</span>(&amp;<span class="ruby-identifier">skip_code</span>)
  <span class="ruby-ivar">@skip_goal_code</span> = <span class="ruby-identifier">skip_code</span>
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- skip_goal-source -->
            
          </div>

          

          
        </div><!-- skip_goal-method -->

      
        <div id="skip_pages_if-method" class="method-detail ">
          <a name="method-i-skip_pages_if"></a>

          
          <div class="method-heading">
            <span class="method-name">skip_pages_if</span><span
              class="method-args">(&skip_code)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Provide a PROC designed to intelligently filter out pages that are not to
be processed. If not called, all pages not defined in :<a
href="Runner.html#attribute-i-only_pages">only_pages</a>, or :skip_pages
parameters in the constructor, or a previous call to <a
href="Runner.html#method-i-only_pages_if">only_pages_if</a> will be
processed. This will override <a
href="Runner.html#attribute-i-only_pages">only_pages</a>, or skip_pages
passed as arguments to the constructor, and any previous call to <a
href="Runner.html#method-i-skip_pages_if">skip_pages_if</a>, or
only_pages_if.  The PROC should take the title of a page as a string, and
return true if a process decides to skip the page, false otherwise. Must be
called before the process! method to affect the pages it processes. 
Returns the runner self to facilitate chained processing with <a
href="Runner.html#method-i-skip_goal">skip_goal</a>, <a
href="Runner.html#method-i-skip_entry">skip_entry</a>, and/or process! if
desired.</p>

<pre>skip pages whose title contains 'skip'
runner.skip_pages_if {|title| title.match(/skip/) }.process!

Same, but without calling process so that skip_entry or skip_goal can be called on the runner
runner.skip_pages_if do |title|
  title.match(/skip/)
end
... can call skip_entry, skip_goal, etc
runner.process!</pre>
            

            
            <div class="method-source-code" id="skip_pages_if-source">
<pre>
<span class="ruby-comment"># File lib/spreadsheet_agent/runner.rb, line 124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_pages_if</span>(&amp;<span class="ruby-identifier">skip_code</span>)
  <span class="ruby-ivar">@only_pages</span> = <span class="ruby-ivar">@db</span>.<span class="ruby-identifier">worksheets</span>.<span class="ruby-identifier">collect</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">title</span> }.<span class="ruby-identifier">reject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">ptitle</span><span class="ruby-operator">|</span> <span class="ruby-identifier">skip_code</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">ptitle</span>) }
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- skip_pages_if-source -->
            
          </div>

          

          
        </div><!-- skip_pages_if-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

